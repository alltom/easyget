<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: EventMachine</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">EventMachine</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/lib/em/deferrable_rb.html">
                lib/em/deferrable.rb
                </a>
        <br />
                <a href="../files/lib/em/eventable_rb.html">
                lib/em/eventable.rb
                </a>
        <br />
                <a href="../files/lib/em/future_rb.html">
                lib/em/future.rb
                </a>
        <br />
                <a href="../files/lib/em/processes_rb.html">
                lib/em/processes.rb
                </a>
        <br />
                <a href="../files/lib/em/spawnable_rb.html">
                lib/em/spawnable.rb
                </a>
        <br />
                <a href="../files/lib/em/streamer_rb.html">
                lib/em/streamer.rb
                </a>
        <br />
                <a href="../files/lib/eventmachine_rb.html">
                lib/eventmachine.rb
                </a>
        <br />
                <a href="../files/lib/eventmachine_version_rb.html">
                lib/eventmachine_version.rb
                </a>
        <br />
                <a href="../files/lib/evma/callback_rb.html">
                lib/evma/callback.rb
                </a>
        <br />
                <a href="../files/lib/jeventmachine_rb.html">
                lib/jeventmachine.rb
                </a>
        <br />
                <a href="../files/lib/pr_eventmachine_rb.html">
                lib/pr_eventmachine.rb
                </a>
        <br />
                <a href="../files/lib/protocols/header_and_content_rb.html">
                lib/protocols/header_and_content.rb
                </a>
        <br />
                <a href="../files/lib/protocols/httpcli2_rb.html">
                lib/protocols/httpcli2.rb
                </a>
        <br />
                <a href="../files/lib/protocols/httpclient_rb.html">
                lib/protocols/httpclient.rb
                </a>
        <br />
                <a href="../files/lib/protocols/line_and_text_rb.html">
                lib/protocols/line_and_text.rb
                </a>
        <br />
                <a href="../files/lib/protocols/linetext2_rb.html">
                lib/protocols/linetext2.rb
                </a>
        <br />
                <a href="../files/lib/protocols/postgres_rb.html">
                lib/protocols/postgres.rb
                </a>
        <br />
                <a href="../files/lib/protocols/saslauth_rb.html">
                lib/protocols/saslauth.rb
                </a>
        <br />
                <a href="../files/lib/protocols/smtpclient_rb.html">
                lib/protocols/smtpclient.rb
                </a>
        <br />
                <a href="../files/lib/protocols/smtpserver_rb.html">
                lib/protocols/smtpserver.rb
                </a>
        <br />
                <a href="../files/lib/protocols/stomp_rb.html">
                lib/protocols/stomp.rb
                </a>
        <br />
                <a href="../files/lib/protocols/tcptest_rb.html">
                lib/protocols/tcptest.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
$Id: tcptest.rb 668 2008-01-04 23:00:34Z blackhedd $
</p>
<table>
<tr><td valign="top">Author:</td><td>Francis Cianfrocca (gmail: blackhedd)

</td></tr>
<tr><td valign="top">Homepage:</td><td><a href="http://rubyeventmachine.com">rubyeventmachine.com</a>

</td></tr>
<tr><td valign="top">Date:</td><td>16 July 2006

</td></tr>
</table>
<p>
See <a href="EventMachine.html">EventMachine</a> and <a
href="EventMachine/Connection.html">EventMachine::Connection</a> for
documentation and usage examples.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000299">add_oneshot_timer</a>&nbsp;&nbsp;
      <a href="#M000276">add_oneshot_timer</a>&nbsp;&nbsp;
      <a href="#M000254">add_periodic_timer</a>&nbsp;&nbsp;
      <a href="#M000253">add_timer</a>&nbsp;&nbsp;
      <a href="#M000260">attach</a>&nbsp;&nbsp;
      <a href="#M000285">close_connection</a>&nbsp;&nbsp;
      <a href="#M000305">close_connection</a>&nbsp;&nbsp;
      <a href="#M000259">connect</a>&nbsp;&nbsp;
      <a href="#M000303">connect_server</a>&nbsp;&nbsp;
      <a href="#M000284">connect_server</a>&nbsp;&nbsp;
      <a href="#M000262">connect_unix_domain</a>&nbsp;&nbsp;
      <a href="#M000309">connect_unix_server</a>&nbsp;&nbsp;
      <a href="#M000266">defer</a>&nbsp;&nbsp;
      <a href="#M000315">epoll</a>&nbsp;&nbsp;
      <a href="#M000290">epoll</a>&nbsp;&nbsp;
      <a href="#M000273">event_callback</a>&nbsp;&nbsp;
      <a href="#M000251">fork_reactor</a>&nbsp;&nbsp;
      <a href="#M000319">get_outbound_data_size</a>&nbsp;&nbsp;
      <a href="#M000311">get_peername</a>&nbsp;&nbsp;
      <a href="#M000298">initialize_event_machine</a>&nbsp;&nbsp;
      <a href="#M000274">initialize_event_machine</a>&nbsp;&nbsp;
      <a href="#M000293">invoke_popen</a>&nbsp;&nbsp;
      <a href="#M000296">library_type</a>&nbsp;&nbsp;
      <a href="#M000297">library_type</a>&nbsp;&nbsp;
      <a href="#M000267">next_tick</a>&nbsp;&nbsp;
      <a href="#M000263">open_datagram_socket</a>&nbsp;&nbsp;
      <a href="#M000272">open_keyboard</a>&nbsp;&nbsp;
      <a href="#M000312">open_udp_socket</a>&nbsp;&nbsp;
      <a href="#M000292">open_udp_socket</a>&nbsp;&nbsp;
      <a href="#M000270">popen</a>&nbsp;&nbsp;
      <a href="#M000271">reactor_running?</a>&nbsp;&nbsp;
      <a href="#M000294">read_keyboard</a>&nbsp;&nbsp;
      <a href="#M000320">read_keyboard</a>&nbsp;&nbsp;
      <a href="#M000261">reconnect</a>&nbsp;&nbsp;
      <a href="#M000275">release_machine</a>&nbsp;&nbsp;
      <a href="#M000301">release_machine</a>&nbsp;&nbsp;
      <a href="#M000249">run</a>&nbsp;&nbsp;
      <a href="#M000250">run_block</a>&nbsp;&nbsp;
      <a href="#M000300">run_machine</a>&nbsp;&nbsp;
      <a href="#M000277">run_machine</a>&nbsp;&nbsp;
      <a href="#M000252">run_without_threads</a>&nbsp;&nbsp;
      <a href="#M000282">send_data</a>&nbsp;&nbsp;
      <a href="#M000304">send_data</a>&nbsp;&nbsp;
      <a href="#M000313">send_datagram</a>&nbsp;&nbsp;
      <a href="#M000283">send_datagram</a>&nbsp;&nbsp;
      <a href="#M000318">send_file_data</a>&nbsp;&nbsp;
      <a href="#M000286">set_comm_inactivity_timeout</a>&nbsp;&nbsp;
      <a href="#M000321">set_comm_inactivity_timeout</a>&nbsp;&nbsp;
      <a href="#M000269">set_descriptor_table_size</a>&nbsp;&nbsp;
      <a href="#M000268">set_effective_user</a>&nbsp;&nbsp;
      <a href="#M000295">set_max_timer_count</a>&nbsp;&nbsp;
      <a href="#M000317">set_max_timer_count</a>&nbsp;&nbsp;
      <a href="#M000265">set_max_timers</a>&nbsp;&nbsp;
      <a href="#M000264">set_quantum</a>&nbsp;&nbsp;
      <a href="#M000316">set_rlimit_nofile</a>&nbsp;&nbsp;
      <a href="#M000291">set_rlimit_nofile</a>&nbsp;&nbsp;
      <a href="#M000314">set_timer_quantum</a>&nbsp;&nbsp;
      <a href="#M000289">set_timer_quantum</a>&nbsp;&nbsp;
      <a href="#M000288">signal_loopbreak</a>&nbsp;&nbsp;
      <a href="#M000310">signal_loopbreak</a>&nbsp;&nbsp;
      <a href="#M000246">spawn</a>&nbsp;&nbsp;
      <a href="#M000256">start_server</a>&nbsp;&nbsp;
      <a href="#M000306">start_tcp_server</a>&nbsp;&nbsp;
      <a href="#M000279">start_tcp_server</a>&nbsp;&nbsp;
      <a href="#M000287">start_tls</a>&nbsp;&nbsp;
      <a href="#M000258">start_unix_domain_server</a>&nbsp;&nbsp;
      <a href="#M000308">start_unix_server</a>&nbsp;&nbsp;
      <a href="#M000281">start_unix_server</a>&nbsp;&nbsp;
      <a href="#M000278">stop</a>&nbsp;&nbsp;
      <a href="#M000302">stop</a>&nbsp;&nbsp;
      <a href="#M000255">stop_event_loop</a>&nbsp;&nbsp;
      <a href="#M000257">stop_server</a>&nbsp;&nbsp;
      <a href="#M000280">stop_tcp_server</a>&nbsp;&nbsp;
      <a href="#M000307">stop_tcp_server</a>&nbsp;&nbsp;
      <a href="#M000247">yield</a>&nbsp;&nbsp;
      <a href="#M000248">yield_and_notify</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Module <a href="EventMachine/Deferrable.html" class="link">EventMachine::Deferrable</a><br />
Module <a href="EventMachine/Eventable.html" class="link">EventMachine::Eventable</a><br />
Module <a href="EventMachine/Protocols.html" class="link">EventMachine::Protocols</a><br />
Module <a href="EventMachine/UuidGenerator.html" class="link">EventMachine::UuidGenerator</a><br />
Class <a href="EventMachine/Connection.html" class="link">EventMachine::Connection</a><br />
Class <a href="EventMachine/DatagramObject.html" class="link">EventMachine::DatagramObject</a><br />
Class <a href="EventMachine/DefaultDeferrable.html" class="link">EventMachine::DefaultDeferrable</a><br />
Class <a href="EventMachine/DeferrableChildProcess.html" class="link">EventMachine::DeferrableChildProcess</a><br />
Class <a href="EventMachine/Error.html" class="link">EventMachine::Error</a><br />
Class <a href="EventMachine/EvmaKeyboard.html" class="link">EventMachine::EvmaKeyboard</a><br />
Class <a href="EventMachine/EvmaTCPClient.html" class="link">EventMachine::EvmaTCPClient</a><br />
Class <a href="EventMachine/EvmaTCPServer.html" class="link">EventMachine::EvmaTCPServer</a><br />
Class <a href="EventMachine/EvmaUDPSocket.html" class="link">EventMachine::EvmaUDPSocket</a><br />
Class <a href="EventMachine/EvmaUNIXClient.html" class="link">EventMachine::EvmaUNIXClient</a><br />
Class <a href="EventMachine/EvmaUNIXServer.html" class="link">EventMachine::EvmaUNIXServer</a><br />
Class <a href="EventMachine/FileStreamer.html" class="link">EventMachine::FileStreamer</a><br />
Class <a href="EventMachine/JEM.html" class="link">EventMachine::JEM</a><br />
Class <a href="EventMachine/LoopbreakReader.html" class="link">EventMachine::LoopbreakReader</a><br />
Class <a href="EventMachine/PeriodicTimer.html" class="link">EventMachine::PeriodicTimer</a><br />
Class <a href="EventMachine/Reactor.html" class="link">EventMachine::Reactor</a><br />
Class <a href="EventMachine/Selectable.html" class="link">EventMachine::Selectable</a><br />
Class <a href="EventMachine/SpawnedProcess.html" class="link">EventMachine::SpawnedProcess</a><br />
Class <a href="EventMachine/StreamObject.html" class="link">EventMachine::StreamObject</a><br />
Class <a href="EventMachine/Timer.html" class="link">EventMachine::Timer</a><br />
Class <a href="EventMachine/YieldBlockFromSpawnedProcess.html" class="link">EventMachine::YieldBlockFromSpawnedProcess</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">VERSION</td>
          <td>=</td>
          <td class="context-item-value">&quot;0.12.2&quot;</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TimerFired</td>
          <td>=</td>
          <td class="context-item-value">100</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
TODO: These event numbers are defined in way too many places. DRY them up.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ConnectionData</td>
          <td>=</td>
          <td class="context-item-value">101</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ConnectionUnbound</td>
          <td>=</td>
          <td class="context-item-value">102</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ConnectionAccepted</td>
          <td>=</td>
          <td class="context-item-value">103</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ConnectionCompleted</td>
          <td>=</td>
          <td class="context-item-value">104</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">LoopbreakSignalled</td>
          <td>=</td>
          <td class="context-item-value">105</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TimerFired</td>
          <td>=</td>
          <td class="context-item-value">100</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ConnectionData</td>
          <td>=</td>
          <td class="context-item-value">101</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ConnectionUnbound</td>
          <td>=</td>
          <td class="context-item-value">102</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ConnectionAccepted</td>
          <td>=</td>
          <td class="context-item-value">103</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ConnectionCompleted</td>
          <td>=</td>
          <td class="context-item-value">104</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">LoopbreakSignalled</td>
          <td>=</td>
          <td class="context-item-value">105</td>
        </tr>
        </table>
      </div>
    </div>



      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000299" class="method-detail">
        <a name="M000299"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000299.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000299.html');return false;">
          <span class="method-name">add_oneshot_timer</span><span class="method-args">(interval)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000276">add_oneshot_timer</a>
</p>
        </div>
      </div>

      <div id="method-M000276" class="method-detail">
        <a name="M000276"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000276.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000276.html');return false;">
          <span class="method-name">add_oneshot_timer</span><span class="method-args">(interval)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000254" class="method-detail">
        <a name="M000254"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000254.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000254.html');return false;">
          <span class="method-name">add_periodic_timer</span><span class="method-args">(*args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000254">EventMachine#add_periodic_timer</a>
adds a periodic timer to the event loop. It takes the same parameters as
the one-shot timer method, <a
href="EventMachine.html#M000253">EventMachine#add_timer</a>. This method
schedules execution of the given block repeatedly, at intervals of time
<em>at least</em> as great as the number of seconds given in the first
parameter to the call.
</p>
<h3>Usage example</h3>
<p>
The following sample program will write a dollar-sign to stderr every five
seconds. (Of course if the program defined network clients and/or servers,
they would be doing their work while the periodic timer is counting off.)
</p>
<pre>
 EventMachine::run {
   EventMachine::add_periodic_timer( 5 ) { $stderr.write &quot;$&quot; }
 }
</pre>
        </div>
      </div>

      <div id="method-M000253" class="method-detail">
        <a name="M000253"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000253.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000253.html');return false;">
          <span class="method-name">add_timer</span><span class="method-args">(*args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000253">EventMachine#add_timer</a> adds a
one-shot timer to the event loop. Call it with one or two parameters. The
first parameters is a delay-time expressed in <em>seconds</em> (not
milliseconds). The second parameter, if present, must be a proc object. If
a proc object is not given, then you can also simply pass a block to the
method call.
</p>
<p>
<a href="EventMachine.html#M000253">EventMachine#add_timer</a> may be
called from the block passed to <a
href="EventMachine.html#M000249">EventMachine#run</a> or from any callback
method. It schedules execution of the proc or block passed to <a
href="EventMachine.html#M000253">add_timer</a>, after the passage of an
interval of time equal to <em>at least</em> the number of seconds specified
in the first parameter to the call.
</p>
<p>
<a href="EventMachine.html#M000253">EventMachine#add_timer</a> is a
<em>non-blocking</em> call. Callbacks can and will be called during the
interval of time that the timer is in effect. There is no built-in limit to
the number of timers that can be outstanding at any given time.
</p>
<h3>Usage example</h3>
<p>
This example shows how easy timers are to use. Observe that two timers are
initiated simultaneously. Also, notice that the event loop will continue to
<a href="EventMachine.html#M000249">run</a> even after the second timer
event is processed, since there was no call to <a
href="EventMachine.html#M000255">EventMachine#stop_event_loop</a>. There
will be no activity, of course, since no network clients or servers are
defined. Stop the program with Ctrl-C.
</p>
<pre>
 require 'rubygems'
 require 'eventmachine'

 EventMachine::run {
   puts &quot;Starting the run now: #{Time.now}&quot;
   EventMachine::add_timer 5, proc { puts &quot;Executing timer event: #{Time.now}&quot; }
   EventMachine::add_timer( 10 ) { puts &quot;Executing timer event: #{Time.now}&quot; }
 }
</pre>
        </div>
      </div>

      <div id="method-M000260" class="method-detail">
        <a name="M000260"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000260.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000260.html');return false;">
          <span class="method-name">attach</span><span class="method-args">(io, handler=nil, *args) {|c| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
EventMachine::attach registers a given file descriptor or <a
href="IO.html">IO</a> object with the eventloop
</p>
<p>
If the handler provided has the functions notify_readable or
notify_writable defined, <a href="EventMachine.html">EventMachine</a> will
not read or write from the socket, and instead fire the corresponding
callback on the handler.
</p>
<p>
To detach the file descriptor, use <a
href="EventMachine/Connection.html#M000529">EventMachine::Connection#detach</a>
</p>
<h3>Usage Example</h3>
<pre>
  module SimpleHttpClient
    def initialize sock
      @sock = sock
    end

    def notify_readable
      header = @sock.readline

      if header == &quot;\r\n&quot;
        # detach returns the file descriptor number (fd == @sock.fileno)
        fd = detach
      end
    rescue EOFError
      detach
    end

    def unbind
      EM.next_tick do
        # socket is detached from the eventloop, but still open
        data = @sock.read
      end
    end
  end

  EM.run{
    $sock = TCPSocket.new('site.com', 80)
    $sock.write(&quot;GET / HTTP/1.0\r\n\r\n&quot;)
    EM.attach $sock, SimpleHttpClient, $sock
  }
</pre>
        </div>
      </div>

      <div id="method-M000285" class="method-detail">
        <a name="M000285"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000285.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000285.html');return false;">
          <span class="method-name">close_connection</span><span class="method-args">(sig, after_writing)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000305" class="method-detail">
        <a name="M000305"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000305.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000305.html');return false;">
          <span class="method-name">close_connection</span><span class="method-args">(target, after_writing)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000285">close_connection</a> The extension
version does NOT raise any kind of an error if an attempt is made to close
a non-existent connection. Not sure whether we should. For now, we&#8216;ll
raise an error here in that case.
</p>
        </div>
      </div>

      <div id="method-M000259" class="method-detail">
        <a name="M000259"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000259.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000259.html');return false;">
          <span class="method-name">connect</span><span class="method-args">(server, port, handler=nil, *args) {|c| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000259">EventMachine#connect</a> initiates a
TCP connection to a remote server and sets up event-handling for the
connection. You can call <a
href="EventMachine.html#M000259">EventMachine#connect</a> in the block
supplied to <a href="EventMachine.html#M000249">EventMachine#run</a> or in
any callback method.
</p>
<p>
<a href="EventMachine.html#M000259">EventMachine#connect</a> takes the IP
address (or hostname) and port of the remote server you want to <a
href="EventMachine.html#M000259">connect</a> to. It also takes an optional
handler Module which you must define, that contains the callbacks that will
be invoked by the event loop on behalf of the connection.
</p>
<p>
See the description of <a
href="EventMachine.html#M000256">EventMachine#start_server</a> for a
discussion of the handler Module. All of the details given in that
description apply for connections created with <a
href="EventMachine.html#M000259">EventMachine#connect</a>.
</p>
<h3>Usage Example</h3>
<p>
Here&#8216;s a program which connects to a web server, sends a naive
request, parses the HTTP header of the response, and then (antisocially)
ends the event loop, which automatically drops the connection (and
incidentally calls the connection&#8216;s unbind method).
</p>
<pre>
 require 'rubygems'
 require 'eventmachine'

 module DumbHttpClient

   def post_init
     send_data &quot;GET / HTTP/1.1\r\nHost: _\r\n\r\n&quot;
     @data = &quot;&quot;
   end

   def receive_data data
     @data &lt;&lt; data
     if  @data =~ /[\n][\r]*[\n]/m
       puts &quot;RECEIVED HTTP HEADER:&quot;
       $`.each {|line| puts &quot;&gt;&gt;&gt; #{line}&quot; }

       puts &quot;Now we'll terminate the loop, which will also close the connection&quot;
       EventMachine::stop_event_loop
     end
   end

   def unbind
     puts &quot;A connection has terminated&quot;
   end

 end # DumbHttpClient

 EventMachine::run {
   EventMachine::connect &quot;www.bayshorenetworks.com&quot;, 80, DumbHttpClient
 }
 puts &quot;The event loop has ended&quot;
</pre>
<p>
There are times when it&#8216;s more convenient to define a protocol
handler as a Class rather than a Module. Here&#8216;s how to do this:
</p>
<pre>
 class MyProtocolHandler &lt; EventMachine::Connection
   def initialize *args
     super
     # whatever else you want to do here
   end

   #.......your other class code
 end # class MyProtocolHandler
</pre>
<p>
If you do this, then an instance of your class will be instantiated to
handle every network connection created by your code or accepted by servers
that you create. If you redefine post_init in your protocol-handler class,
your post_init method will be called <em>inside</em> the call to super that
you will make in your initialize method (if you provide one).
</p>
        </div>
      </div>

      <div id="method-M000303" class="method-detail">
        <a name="M000303"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000303.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000303.html');return false;">
          <span class="method-name">connect_server</span><span class="method-args">(host, port)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000284">connect_server</a>. Return a connection
descriptor to the caller. TODO, what do we return here if we can&#8216;t
connect?
</p>
        </div>
      </div>

      <div id="method-M000284" class="method-detail">
        <a name="M000284"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000284.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000284.html');return false;">
          <span class="method-name">connect_server</span><span class="method-args">(server, port)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000262" class="method-detail">
        <a name="M000262"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000262.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000262.html');return false;">
          <span class="method-name">connect_unix_domain</span><span class="method-args">(socketname, handler=nil, *args) {|c| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Make a connection to a Unix-domain socket. This is not implemented on
Windows platforms. The parameter socketname is a String which identifies
the Unix-domain socket you want to <a
href="EventMachine.html#M000259">connect</a> to. socketname is the name of
a file on your local system, and in most cases is a fully-qualified path
name. Make sure that your process has enough local permissions to open the
Unix-domain socket. See also the documentation for <a
href="EventMachine.html#M000284">connect_server</a>. This method behaves
like <a href="EventMachine.html#M000284">connect_server</a> in all respects
except for the fact that it connects to a local Unix-domain socket rather
than a TCP socket. NOTE: this functionality will soon be subsumed into the
<a href="EventMachine.html#M000259">connect</a> method. This method will
still be supported as an alias.
</p>
        </div>
      </div>

      <div id="method-M000309" class="method-detail">
        <a name="M000309"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000309.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000309.html');return false;">
          <span class="method-name">connect_unix_server</span><span class="method-args">(chain)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000309">connect_unix_server</a>
</p>
        </div>
      </div>

      <div id="method-M000266" class="method-detail">
        <a name="M000266"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000266.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000266.html');return false;">
          <span class="method-name">defer</span><span class="method-args">(op, callback = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000266">defer</a> is for integrating blocking
operations into <a href="EventMachine.html">EventMachine</a>&#8216;s
control flow. Call <a href="EventMachine.html#M000266">defer</a> with one
or two blocks, as shown below (the second block is <em>optional</em>):
</p>
<pre>
 operation = proc {
   # perform a long-running operation here, such as a database query.
   &quot;result&quot; # as usual, the last expression evaluated in the block will be the return value.
 }
 callback = proc {|result|
   # do something with result here, such as send it back to a network client.
 }

 EventMachine.defer( operation, callback )
</pre>
<p>
The action of <a href="EventMachine.html#M000266">defer</a> is to take the
block specified in the first parameter (the &quot;operation&quot;) and
schedule it for asynchronous execution on an internal thread pool
maintained by <a href="EventMachine.html">EventMachine</a>. When the
operation completes, it will pass the result computed by the block (if any)
back to the <a href="EventMachine.html">EventMachine</a> reactor. Then, <a
href="EventMachine.html">EventMachine</a> calls the block specified in the
second parameter to <a href="EventMachine.html#M000266">defer</a> (the
&quot;callback&quot;), as part of its normal, synchronous event handling
loop. The result computed by the operation block is passed as a parameter
to the callback. You may omit the callback parameter if you don&#8216;t
need to execute any code after the operation completes.
</p>
<p>
<em>Caveats:</em> Note carefully that the code in your deferred operation
will be executed on a separate thread from the main <a
href="EventMachine.html">EventMachine</a> processing and all other Ruby
threads that may exist in your program. Also, multiple deferred operations
may be running at once! Therefore, you are responsible for ensuring that
your operation code is threadsafe. [Need more explanation and examples.]
Don&#8216;t write a deferred operation that will block forever. If so, the
current implementation will not detect the problem, and the thread will
never be returned to the pool. <a href="EventMachine.html">EventMachine</a>
limits the number of threads in its pool, so if you do this enough times,
your subsequent deferred operations won&#8216;t get a chance to <a
href="EventMachine.html#M000249">run</a>. [We might put in a timer to
detect this problem.]
</p>
        </div>
      </div>

      <div id="method-M000315" class="method-detail">
        <a name="M000315"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000315.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000315.html');return false;">
          <span class="method-name">epoll</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000290">epoll</a> is a harmless no-op in the
pure-Ruby implementation. This is intended to ensure that user code behaves
properly across different EM implementations.
</p>
        </div>
      </div>

      <div id="method-M000290" class="method-detail">
        <a name="M000290"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000290.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000290.html');return false;">
          <span class="method-name">epoll</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000273" class="method-detail">
        <a name="M000273"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000273.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000273.html');return false;">
          <span class="method-name">event_callback</span><span class="method-args">(target, opcode, data)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000251" class="method-detail">
        <a name="M000251"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000251.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000251.html');return false;">
          <span class="method-name">fork_reactor</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000251">fork_reactor</a> forks a new process
and calls EM#run inside of it, passing your block.
</p>
        </div>
      </div>

      <div id="method-M000319" class="method-detail">
        <a name="M000319"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000319.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000319.html');return false;">
          <span class="method-name">get_outbound_data_size</span><span class="method-args">(sig)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000319">get_outbound_data_size</a>
</p>
        </div>
      </div>

      <div id="method-M000311" class="method-detail">
        <a name="M000311"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000311.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000311.html');return false;">
          <span class="method-name">get_peername</span><span class="method-args">(sig)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000311">get_peername</a>
</p>
        </div>
      </div>

      <div id="method-M000298" class="method-detail">
        <a name="M000298"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000298.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000298.html');return false;">
          <span class="method-name">initialize_event_machine</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000274">initialize_event_machine</a>
</p>
        </div>
      </div>

      <div id="method-M000274" class="method-detail">
        <a name="M000274"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000274.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000274.html');return false;">
          <span class="method-name">initialize_event_machine</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000293" class="method-detail">
        <a name="M000293"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000293.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000293.html');return false;">
          <span class="method-name">invoke_popen</span><span class="method-args">(cmd)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000296" class="method-detail">
        <a name="M000296"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000296.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000296.html');return false;">
          <span class="method-name">library_type</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000297" class="method-detail">
        <a name="M000297"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000297.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000297.html');return false;">
          <span class="method-name">library_type</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This is mostly useful for automated tests. Return a distinctive symbol so
the caller knows whether he&#8216;s dealing with an extension or with a
pure-Ruby library.
</p>
        </div>
      </div>

      <div id="method-M000267" class="method-detail">
        <a name="M000267"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000267.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000267.html');return false;">
          <span class="method-name">next_tick</span><span class="method-args">(pr=nil, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Schedules a proc for execution immediately after the next &quot;turn&quot;
through the reactor core. An advanced technique, this can be useful for
improving memory management and/or application responsiveness, especially
when scheduling large amounts of data for writing to a network connection.
TODO, we need a FAQ entry on this subject.
</p>
<p>
<a href="EventMachine.html#M000267">next_tick</a> takes either a single
argument (which must be a Proc) or a block. And I&#8216;m taking
suggestions for a better name for this method.
</p>
        </div>
      </div>

      <div id="method-M000263" class="method-detail">
        <a name="M000263"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000263.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000263.html');return false;">
          <span class="method-name">open_datagram_socket</span><span class="method-args">(address, port, handler=nil, *args) {|c| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000263">EventMachine#open_datagram_socket</a>
is for support of UDP-based protocols. Its usage is similar to that of <a
href="EventMachine.html#M000256">EventMachine#start_server</a>. It takes
three parameters: an IP address (which must be valid on the machine which
executes the method), a port number, and an optional Module name which will
handle the data. This method will create a new UDP (datagram) socket and
bind it to the address and port that you specify. The normal callbacks (see
<a href="EventMachine.html#M000256">EventMachine#start_server</a>) will be
called as events of interest occur on the newly-created socket, but there
are some differences in how they behave.
</p>
<p>
<a href="EventMachine/Connection.html#M000526">Connection#receive_data</a>
will be called when a datagram packet is received on the socket, but unlike
TCP sockets, the message boundaries of the received data will be respected.
In other words, if the remote peer sent you a datagram of a particular
size, you may rely on <a
href="EventMachine/Connection.html#M000526">Connection#receive_data</a> to
give you the exact data in the packet, with the original data length. Also
observe that <a
href="EventMachine/Connection.html#M000526">Connection#receive_data</a> may
be called with a <em>zero-length</em> data payload, since empty datagrams
are permitted in UDP.
</p>
<p>
<a href="EventMachine/Connection.html#M000531">Connection#send_data</a> is
available with UDP packets as with TCP, but there is an important
difference. Because UDP communications are <em>connectionless,</em> there
is no implicit recipient for the packets you send. Ordinarily you must
specify the recipient for each packet you send. However, <a
href="EventMachine.html">EventMachine</a> provides for the typical pattern
of receiving a UDP datagram from a remote peer, performing some operation,
and then sending one or more packets in response to the same remote peer.
To support this model easily, just use <a
href="EventMachine/Connection.html#M000531">Connection#send_data</a> in the
code that you supply for <a
href="EventMachine/Connection.html">Connection</a>:receive_data. <a
href="EventMachine.html">EventMachine</a> will provide an implicit return
address for any messages sent to <a
href="EventMachine/Connection.html#M000531">Connection#send_data</a> within
the context of a <a
href="EventMachine/Connection.html#M000526">Connection#receive_data</a>
callback, and your response will automatically go to the correct remote
peer. (TODO: Example-code needed!)
</p>
<p>
Observe that the port number that you supply to <a
href="EventMachine.html#M000263">EventMachine#open_datagram_socket</a> may
be zero. In this case, <a href="EventMachine.html">EventMachine</a> will
create a UDP socket that is bound to an <em>ephemeral</em> (not well-known)
port. This is not appropriate for servers that must publish a well-known
port to which remote peers may send datagrams. But it can be useful for
clients that send datagrams to other servers. If you do this, you will
receive any responses from the remote servers through the normal <a
href="EventMachine/Connection.html#M000526">Connection#receive_data</a>
callback. Observe that you will probably have issues with firewalls
blocking the ephemeral port numbers, so this technique is most appropriate
for LANs. (TODO: Need an example!)
</p>
<p>
If you wish to send datagrams to arbitrary remote peers (not necessarily
ones that have sent data to which you are responding), then see <a
href="EventMachine/Connection.html#M000535">Connection#send_datagram</a>.
</p>
<p>
DO NOT call <a href="EventMachine.html#M000282">send_data</a> from a
datagram socket outside of a receive_data method. Use <a
href="EventMachine.html#M000283">send_datagram</a>. If you do use <a
href="EventMachine.html#M000282">send_data</a> outside of a receive_data
method, you&#8216;ll get a confusing error because there is no
&quot;peer,&quot; as <a href="EventMachine.html#M000282">send_data</a>
requires. (Inside of receive_data, <a
href="EventMachine.html#M000282">send_data</a> &quot;fakes&quot; the peer
as described above.)
</p>
        </div>
      </div>

      <div id="method-M000272" class="method-detail">
        <a name="M000272"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000272.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000272.html');return false;">
          <span class="method-name">open_keyboard</span><span class="method-args">(handler=nil, *args) {|c| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
(Experimental)
</p>
        </div>
      </div>

      <div id="method-M000312" class="method-detail">
        <a name="M000312"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000312.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000312.html');return false;">
          <span class="method-name">open_udp_socket</span><span class="method-args">(host, port)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000292">open_udp_socket</a>
</p>
        </div>
      </div>

      <div id="method-M000292" class="method-detail">
        <a name="M000292"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000292.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000292.html');return false;">
          <span class="method-name">open_udp_socket</span><span class="method-args">(server, port)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000270" class="method-detail">
        <a name="M000270"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000270.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000270.html');return false;">
          <span class="method-name">popen</span><span class="method-args">(cmd, handler=nil) {|c| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
TODO, must document <a href="EventMachine.html#M000270">popen</a>. At this
moment, it&#8216;s only available on Unix. This limitation is expected to
go away.
</p>
        </div>
      </div>

      <div id="method-M000271" class="method-detail">
        <a name="M000271"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000271.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000271.html');return false;">
          <span class="method-name">reactor_running?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Tells you whether the <a href="EventMachine.html">EventMachine</a> reactor
loop is currently running. Returns true or false. Useful when writing
libraries that want to <a href="EventMachine.html#M000249">run</a>
event-driven code, but may be running in programs that are already
event-driven. In such cases, if EventMachine#reactor_running? returns
false, your code can invoke <a
href="EventMachine.html#M000249">EventMachine#run</a> and <a
href="EventMachine.html#M000249">run</a> your application code inside the
block passed to that method. If EventMachine#reactor_running? returns true,
just execute your event-aware code.
</p>
<p>
This method is necessary because calling <a
href="EventMachine.html#M000249">EventMachine#run</a> inside of another
call to <a href="EventMachine.html#M000249">EventMachine#run</a> generates
a fatal error.
</p>
        </div>
      </div>

      <div id="method-M000294" class="method-detail">
        <a name="M000294"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000294.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000294.html');return false;">
          <span class="method-name">read_keyboard</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000320" class="method-detail">
        <a name="M000320"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000320.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000320.html');return false;">
          <span class="method-name">read_keyboard</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000294">read_keyboard</a>
</p>
        </div>
      </div>

      <div id="method-M000261" class="method-detail">
        <a name="M000261"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000261.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000261.html');return false;">
          <span class="method-name">reconnect</span><span class="method-args">(server, port, handler) {|handler| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000275" class="method-detail">
        <a name="M000275"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000275.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000275.html');return false;">
          <span class="method-name">release_machine</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000301" class="method-detail">
        <a name="M000301"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000301.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000301.html');return false;">
          <span class="method-name">release_machine</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000275">release_machine</a>. Probably a no-op.
</p>
        </div>
      </div>

      <div id="method-M000249" class="method-detail">
        <a name="M000249"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000249.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000249.html');return false;">
          <span class="method-name">run</span><span class="method-args">(blk=nil, tail=nil, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
EventMachine::run initializes and runs an event loop. This method only
returns if user-callback code calls <a
href="EventMachine.html#M000255">stop_event_loop</a>. Use the supplied
block to define your clients and servers. The block is called by
EventMachine::run immediately after initializing its internal event loop
but <em>before</em> running the loop. Therefore this block is the right
place to call <a href="EventMachine.html#M000256">start_server</a> if you
want to accept connections from remote clients.
</p>
<p>
For programs that are structured as servers, it&#8216;s usually appropriate
to start an event loop by calling EventMachine::run, and let it <a
href="EventMachine.html#M000249">run</a> forever. It&#8216;s also possible
to use EventMachine::run to make a single client-connection to a remote
server, process the data flow from that single connection, and then call <a
href="EventMachine.html#M000255">stop_event_loop</a> to force
EventMachine::run to return. Your program will then continue from the point
immediately following the call to EventMachine::run.
</p>
<p>
You can of course do both client and servers simultaneously in the same
program. One of the strengths of the event-driven programming model is that
the handling of network events on many different connections will be
interleaved, and scheduled according to the actual events themselves. This
maximizes efficiency.
</p>
<h3>Server usage example</h3>
<p>
See the text at the top of this file for an example of an echo server.
</p>
<h3>Client usage example</h3>
<p>
See the description of <a
href="EventMachine.html#M000255">stop_event_loop</a> for an extremely
simple client example.
</p>
        </div>
      </div>

      <div id="method-M000250" class="method-detail">
        <a name="M000250"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000250.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000250.html');return false;">
          <span class="method-name">run_block</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sugars a common use case. Will pass the given block to <a
href="EventMachine.html#M000249">run</a>, but will terminate the reactor
loop and exit the function as soon as the code in the block completes.
(Normally, <a href="EventMachine.html#M000249">run</a> keeps running
indefinitely, even after the block supplied to it finishes running, until
user code calls <a href="EventMachine.html#M000278">stop</a>.)
</p>
        </div>
      </div>

      <div id="method-M000300" class="method-detail">
        <a name="M000300"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000300.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000300.html');return false;">
          <span class="method-name">run_machine</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000277">run_machine</a>
</p>
        </div>
      </div>

      <div id="method-M000277" class="method-detail">
        <a name="M000277"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000277.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000277.html');return false;">
          <span class="method-name">run_machine</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000252" class="method-detail">
        <a name="M000252"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000252.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000252.html');return false;">
          <span class="method-name">run_without_threads</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<tt>deprecated</tt>
</p>
        </div>
      </div>

      <div id="method-M000282" class="method-detail">
        <a name="M000282"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000282.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000282.html');return false;">
          <span class="method-name">send_data</span><span class="method-args">(sig, data, length)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000304" class="method-detail">
        <a name="M000304"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000304.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000304.html');return false;">
          <span class="method-name">send_data</span><span class="method-args">(target, data, datalength)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000282">send_data</a>
</p>
        </div>
      </div>

      <div id="method-M000313" class="method-detail">
        <a name="M000313"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000313.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000313.html');return false;">
          <span class="method-name">send_datagram</span><span class="method-args">(target, data, datalength, host, port)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000283">send_datagram</a>. This is currently
only for UDP! We need to make it work with unix-domain sockets as well.
</p>
        </div>
      </div>

      <div id="method-M000283" class="method-detail">
        <a name="M000283"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000283.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000283.html');return false;">
          <span class="method-name">send_datagram</span><span class="method-args">(sig, data, length, address, port)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000318" class="method-detail">
        <a name="M000318"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000318.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000318.html');return false;">
          <span class="method-name">send_file_data</span><span class="method-args">(sig, filename)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000318">send_file_data</a>
</p>
        </div>
      </div>

      <div id="method-M000286" class="method-detail">
        <a name="M000286"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000286.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000286.html');return false;">
          <span class="method-name">set_comm_inactivity_timeout</span><span class="method-args">(sig, interval)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000321" class="method-detail">
        <a name="M000321"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000321.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000321.html');return false;">
          <span class="method-name">set_comm_inactivity_timeout</span><span class="method-args">(sig, tm)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000286">set_comm_inactivity_timeout</a>
</p>
        </div>
      </div>

      <div id="method-M000269" class="method-detail">
        <a name="M000269"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000269.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000269.html');return false;">
          <span class="method-name">set_descriptor_table_size</span><span class="method-args">(n_descriptors=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the maximum number of file or socket descriptors that your process may
open. You can pass this method an integer specifying the new size of the
descriptor table. Returns the new descriptor-table size, which may be less
than the number you requested. If you call this method with no arguments,
it will simply return the current size of the descriptor table without
attempting to change it.
</p>
<p>
The new limit on open descriptors ONLY applies to sockets and other
descriptors that belong to <a href="EventMachine.html">EventMachine</a>. It
has NO EFFECT on the number of descriptors you can create in ordinary Ruby
code.
</p>
<p>
Not available on all platforms. Increasing the number of descriptors beyond
its default limit usually requires superuser privileges. (See <a
href="EventMachine.html#M000268">set_effective_user</a> for a way to drop
superuser privileges while your program is running.)
</p>
        </div>
      </div>

      <div id="method-M000268" class="method-detail">
        <a name="M000268"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000268.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000268.html');return false;">
          <span class="method-name">set_effective_user</span><span class="method-args">(username)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A wrapper over the setuid system call. Particularly useful when opening a
network server on a privileged port because you can use this call to drop
privileges after opening the port. Also very useful after a call to <a
href="EventMachine.html#M000269">set_descriptor_table_size</a>, which
generally requires that you start your process with root privileges.
</p>
<p>
This method has no effective implementation on Windows or in the pure-Ruby
implementation of <a href="EventMachine.html">EventMachine</a>. Call <a
href="EventMachine.html#M000268">set_effective_user</a> by passing it a
string containing the effective name of the user whose privilege-level your
process should attain. This method is intended for use in enforcing
security requirements, consequently it will throw a fatal error and end
your program if it fails.
</p>
        </div>
      </div>

      <div id="method-M000295" class="method-detail">
        <a name="M000295"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000295.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000295.html');return false;">
          <span class="method-name">set_max_timer_count</span><span class="method-args">(num)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000317" class="method-detail">
        <a name="M000317"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000317.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000317.html');return false;">
          <span class="method-name">set_max_timer_count</span><span class="method-args">(n)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000295">set_max_timer_count</a> is a harmless
no-op in pure Ruby, which doesn&#8216;t have a built-in limit on the number
of available timers.
</p>
        </div>
      </div>

      <div id="method-M000265" class="method-detail">
        <a name="M000265"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000265.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000265.html');return false;">
          <span class="method-name">set_max_timers</span><span class="method-args">(ct)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the maximum number of timers and periodic timers that may be
outstanding at any given time. You only need to call <a
href="EventMachine.html#M000265">set_max_timers</a> if you need more than
the default number of timers, which on most platforms is 1000. Call this
method before calling <a
href="EventMachine.html#M000249">EventMachine#run</a>.
</p>
        </div>
      </div>

      <div id="method-M000264" class="method-detail">
        <a name="M000264"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000264.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000264.html');return false;">
          <span class="method-name">set_quantum</span><span class="method-args">(mills)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
For advanced users. This function sets the default timer granularity, which
by default is slightly smaller than 100 milliseconds. Call this function to
set a higher or lower granularity. The function affects the behavior of <a
href="EventMachine.html#M000253">add_timer</a> and <a
href="EventMachine.html#M000254">add_periodic_timer</a>. Most applications
will not need to call this function.
</p>
<p>
The argument is a number of milliseconds. Avoid setting the quantum to very
low values because that may reduce performance under some extreme
conditions. We recommend that you not set a quantum lower than 10.
</p>
<p>
You may only call this function while an <a
href="EventMachine.html">EventMachine</a> loop is running (that is, after a
call to <a href="EventMachine.html#M000249">EventMachine#run</a> and before
a subsequent call to <a
href="EventMachine.html#M000278">EventMachine#stop</a>).
</p>
        </div>
      </div>

      <div id="method-M000316" class="method-detail">
        <a name="M000316"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000316.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000316.html');return false;">
          <span class="method-name">set_rlimit_nofile</span><span class="method-args">(n)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000291">set_rlimit_nofile</a> is a no-op in the
pure-Ruby implementation. We simply return Ruby&#8216;s built-in
per-process file-descriptor limit.
</p>
        </div>
      </div>

      <div id="method-M000291" class="method-detail">
        <a name="M000291"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000291.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000291.html');return false;">
          <span class="method-name">set_rlimit_nofile</span><span class="method-args">(n_descriptors)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000314" class="method-detail">
        <a name="M000314"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000314.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000314.html');return false;">
          <span class="method-name">set_timer_quantum</span><span class="method-args">(interval)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000289">set_timer_quantum</a> in milliseconds.
The underlying <a href="EventMachine/Reactor.html">Reactor</a> function
wants a (possibly fractional) number of seconds.
</p>
        </div>
      </div>

      <div id="method-M000289" class="method-detail">
        <a name="M000289"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000289.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000289.html');return false;">
          <span class="method-name">set_timer_quantum</span><span class="method-args">(q)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000288" class="method-detail">
        <a name="M000288"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000288.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000288.html');return false;">
          <span class="method-name">signal_loopbreak</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000310" class="method-detail">
        <a name="M000310"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000310.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000310.html');return false;">
          <span class="method-name">signal_loopbreak</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000288">signal_loopbreak</a>
</p>
        </div>
      </div>

      <div id="method-M000246" class="method-detail">
        <a name="M000246"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000246.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000246.html');return false;">
          <span class="method-name">spawn</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000256" class="method-detail">
        <a name="M000256"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000256.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000256.html');return false;">
          <span class="method-name">start_server</span><span class="method-args">(server, port, handler=nil, *args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
EventMachine::start_server initiates a TCP server (socket acceptor) on the
specified IP address and port. The IP address must be valid on the machine
where the program runs, and the process must be privileged enough to listen
on the specified port (on Unix-like systems, superuser privileges are
usually required to listen on any port lower than 1024). Only one listener
may be running on any given address/port combination. <a
href="EventMachine.html#M000256">start_server</a> will fail if the given
address and port are already listening on the machine, either because of a
prior call to <a href="EventMachine.html#M000256">start_server</a> or some
unrelated process running on the machine. If <a
href="EventMachine.html#M000256">start_server</a> succeeds, the new network
listener becomes active immediately and starts accepting connections from
remote peers, and these connections generate callback events that are
processed by the code specified in the handler parameter to <a
href="EventMachine.html#M000256">start_server</a>.
</p>
<p>
The optional handler which is passed to <a
href="EventMachine.html#M000256">start_server</a> is the key to <a
href="EventMachine.html">EventMachine</a>&#8216;s ability to handle
particular network protocols. The handler parameter passed to <a
href="EventMachine.html#M000256">start_server</a> must be a Ruby Module
that you must define. When the network server that is started by <a
href="EventMachine.html#M000256">start_server</a> accepts a new connection,
it instantiates a new object of an anonymous class that is inherited from
<a href="EventMachine/Connection.html">EventMachine::Connection</a>,
<em>into which the methods from your handler have been mixed.</em> Your
handler module may redefine any of the methods in <a
href="EventMachine/Connection.html">EventMachine::Connection</a> in order
to implement the specific behavior of the network protocol.
</p>
<p>
Callbacks invoked in response to network events <em>always</em> take place
within the execution context of the object derived from <a
href="EventMachine/Connection.html">EventMachine::Connection</a> extended
by your handler module. There is one object per connection, and all of the
callbacks invoked for a particular connection take the form of instance
methods called against the corresponding <a
href="EventMachine/Connection.html">EventMachine::Connection</a> object.
Therefore, you are free to define whatever instance variables you wish, in
order to contain the per-connection state required by the network protocol
you are implementing.
</p>
<p>
<a href="EventMachine.html#M000256">start_server</a> is often called inside
the block passed to EventMachine::run, but it can be called from any <a
href="EventMachine.html">EventMachine</a> callback. <a
href="EventMachine.html#M000256">start_server</a> will fail unless the <a
href="EventMachine.html">EventMachine</a> event loop is currently running
(which is why it&#8216;s often called in the block suppled to
EventMachine::run).
</p>
<p>
You may call <a href="EventMachine.html#M000256">start_server</a> any
number of times to start up network listeners on different address/port
combinations. The servers will all <a
href="EventMachine.html#M000249">run</a> simultaneously. More
interestingly, each individual call to <a
href="EventMachine.html#M000256">start_server</a> can specify a different
handler module and thus implement a different network protocol from all the
others.
</p>
<h3>Usage example</h3>
<p>
Here is an example of a server that counts lines of input from the remote
peer and sends back the total number of lines received, after each line.
Try the example with more than one client connection opened via telnet, and
you will see that the line count increments independently on each of the
client connections. Also very important to note, is that the handler for
the receive_data function, which our handler redefines, may not assume that
the data it receives observes any kind of message boundaries. Also, to use
this example, be sure to change the server and port parameters to the <a
href="EventMachine.html#M000256">start_server</a> call to values
appropriate for your environment.
</p>
<pre>
 require 'rubygems'
 require 'eventmachine'

 module LineCounter

   MaxLinesPerConnection = 10

   def post_init
     puts &quot;Received a new connection&quot;
     @data_received = &quot;&quot;
     @line_count = 0
   end

   def receive_data data
     @data_received &lt;&lt; data
     while @data_received.slice!( /^[^\n]*[\n]/m )
       @line_count += 1
       send_data &quot;received #{@line_count} lines so far\r\n&quot;
       @line_count == MaxLinesPerConnection and close_connection_after_writing
     end
   end

 end # module LineCounter

 EventMachine::run {
   host,port = &quot;192.168.0.100&quot;, 8090
   EventMachine::start_server host, port, LineCounter
   puts &quot;Now accepting connections on address #{host}, port #{port}...&quot;
   EventMachine::add_periodic_timer( 10 ) { $stderr.write &quot;*&quot; }
 }
</pre>
        </div>
      </div>

      <div id="method-M000306" class="method-detail">
        <a name="M000306"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000306.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000306.html');return false;">
          <span class="method-name">start_tcp_server</span><span class="method-args">(host, port)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000279">start_tcp_server</a>
</p>
        </div>
      </div>

      <div id="method-M000279" class="method-detail">
        <a name="M000279"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000279.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000279.html');return false;">
          <span class="method-name">start_tcp_server</span><span class="method-args">(server, port)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000287" class="method-detail">
        <a name="M000287"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000287.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000287.html');return false;">
          <span class="method-name">start_tls</span><span class="method-args">(sig)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000258" class="method-detail">
        <a name="M000258"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000258.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000258.html');return false;">
          <span class="method-name">start_unix_domain_server</span><span class="method-args">(filename, handler=nil, *args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000308" class="method-detail">
        <a name="M000308"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000308.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000308.html');return false;">
          <span class="method-name">start_unix_server</span><span class="method-args">(chain)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000281">start_unix_server</a>
</p>
        </div>
      </div>

      <div id="method-M000281" class="method-detail">
        <a name="M000281"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000281.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000281.html');return false;">
          <span class="method-name">start_unix_server</span><span class="method-args">(filename)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000278" class="method-detail">
        <a name="M000278"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000278.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000278.html');return false;">
          <span class="method-name">stop</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000302" class="method-detail">
        <a name="M000302"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000302.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000302.html');return false;">
          <span class="method-name">stop</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000278">stop</a>
</p>
        </div>
      </div>

      <div id="method-M000255" class="method-detail">
        <a name="M000255"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000255.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000255.html');return false;">
          <span class="method-name">stop_event_loop</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000255">stop_event_loop</a> may called from
within a callback method while <a
href="EventMachine.html">EventMachine</a>&#8216;s processing loop is
running. It causes the processing loop to <a
href="EventMachine.html#M000278">stop</a> executing, which will cause all
open connections and accepting servers to be <a
href="EventMachine.html#M000249">run</a> down and closed. <em>Callbacks for
connection-termination will be called</em> as part of the processing of <a
href="EventMachine.html#M000255">stop_event_loop</a>. (There currently is
no option to panic-<a href="EventMachine.html#M000278">stop</a> the loop
without closing connections.) When all of this processing is complete, the
call to EventMachine::run which started the processing loop will return and
program flow will resume from the statement following EventMachine::run
call.
</p>
<h3>Usage example</h3>
<pre>
 require 'rubygems'
 require 'eventmachine'

 module Redmond

   def post_init
     puts &quot;We're sending a dumb HTTP request to the remote peer.&quot;
     send_data &quot;GET / HTTP/1.1\r\nHost: www.microsoft.com\r\n\r\n&quot;
   end

   def receive_data data
     puts &quot;We received #{data.length} bytes from the remote peer.&quot;
     puts &quot;We're going to stop the event loop now.&quot;
     EventMachine::stop_event_loop
   end

   def unbind
     puts &quot;A connection has terminated.&quot;
   end

 end

 puts &quot;We're starting the event loop now.&quot;
 EventMachine::run {
   EventMachine::connect &quot;www.microsoft.com&quot;, 80, Redmond
 }
 puts &quot;The event loop has stopped.&quot;
</pre>
<p>
This program will produce approximately the following output:
</p>
<pre>
 We're starting the event loop now.
 We're sending a dumb HTTP request to the remote peer.
 We received 1440 bytes from the remote peer.
 We're going to stop the event loop now.
 A connection has terminated.
 The event loop has stopped.
</pre>
        </div>
      </div>

      <div id="method-M000257" class="method-detail">
        <a name="M000257"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000257.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000257.html');return false;">
          <span class="method-name">stop_server</span><span class="method-args">(signature)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Stop a TCP server socket that was started with <a
href="EventMachine.html#M000256">EventMachine#start_server</a>.
</p>
        </div>
      </div>

      <div id="method-M000280" class="method-detail">
        <a name="M000280"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000280.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000280.html');return false;">
          <span class="method-name">stop_tcp_server</span><span class="method-args">(sig)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000307" class="method-detail">
        <a name="M000307"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000307.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000307.html');return false;">
          <span class="method-name">stop_tcp_server</span><span class="method-args">(sig)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="EventMachine.html#M000280">stop_tcp_server</a>
</p>
        </div>
      </div>

      <div id="method-M000247" class="method-detail">
        <a name="M000247"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000247.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000247.html');return false;">
          <span class="method-name">yield</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000248" class="method-detail">
        <a name="M000248"></a>

        <div class="method-heading">
          <a href="EventMachine.src/M000248.html" target="Code" class="method-signature"
            onclick="popupCode('EventMachine.src/M000248.html');return false;">
          <span class="method-name">yield_and_notify</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>